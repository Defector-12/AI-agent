import{d as p,e as u,f as h,g as v,c,a as l,F as m,h as _,i as g,v as f,j as w,o as d,n as y,t as b,k,_ as S}from"./index-B1JUJUty.js";const C={class:"chat-window"},B={class:"bubble"},x={class:"composer"},E=["placeholder"],F=["disabled"],T=p({__name:"ChatWindow",props:{placeholder:{},onSend:{type:Function},loading:{type:Boolean},messages:{}},setup(r){const a=r,e=u(""),n=u(null),t=()=>{const s=e.value.trim();!s||a.loading||(a.onSend(s),e.value="")};return h(()=>a.messages.length,async()=>{await k();const s=n.value;s&&(s.scrollTop=s.scrollHeight)}),v(()=>{e.value=""}),(s,i)=>(d(),c("div",C,[l("div",{class:"messages",ref_key:"listRef",ref:n},[(d(!0),c(m,null,_(s.messages,o=>(d(),c("div",{key:o.id,class:y(["message",o.role])},[l("div",B,b(o.content),1)],2))),128))],512),l("div",x,[g(l("input",{"onUpdate:modelValue":i[0]||(i[0]=o=>e.value=o),class:"input",type:"text",placeholder:s.placeholder,onKeydown:w(t,["enter"])},null,40,E),[[f,e.value]]),l("button",{class:"send",disabled:s.loading||!e.value.trim(),onClick:t},"发送",8,F)])]))}}),K=S(T,[["__scopeId","data-v-71b895e4"]]);function M(r,a){const e=new EventSource(r);return e.onmessage=n=>{a.onMessage(n.data)},e.onerror=n=>{var t;(t=a.onError)==null||t.call(a,n),e.close()},e}export{K as C,M as o};
