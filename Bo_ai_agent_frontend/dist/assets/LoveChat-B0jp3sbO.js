import{C as p,o as v}from"./sse-BO-sLDFv.js";import{d as m,e as s,c as _,a as u,b as g,t as h,o as f,_ as I}from"./index-B1JUJUty.js";const C={class:"desc"},S=m({__name:"LoveChat",setup(U){function d(){return"love_"+Math.random().toString(36).slice(2)+Date.now().toString(36)}const l=s(d()),a=s([]),o=s(!1);let e=null;const i=t=>{a.value.push({id:crypto.randomUUID(),role:"user",content:t}),o.value=!0,e&&(e.close(),e=null);const n=`/api/ai/love_app/chat/sse?message=${encodeURIComponent(t)}&chatId=${encodeURIComponent(l.value)}`;e=v(n,{onMessage:r=>{var c;((c=a.value[a.value.length-1])==null?void 0:c.role)==="ai"?a.value[a.value.length-1].content+=r:a.value.push({id:crypto.randomUUID(),role:"ai",content:r})},onError:()=>{o.value=!1,e==null||e.close(),e=null}}),setTimeout(()=>{o.value=!1},8e4)};return(t,n)=>(f(),_("div",null,[n[0]||(n[0]=u("h2",null,"AI 恋爱大师",-1)),u("p",C,"进入页面自动生成聊天室 ID："+h(l.value),1),g(p,{messages:a.value,loading:o.value,placeholder:"对恋爱/情感相关的问题说点什么...",onSend:i},null,8,["messages","loading"])]))}}),y=I(S,[["__scopeId","data-v-67ccb5bd"]]);export{y as default};
